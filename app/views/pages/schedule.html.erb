<div class="home-page-holder">
  <div class="home-block-holder">
    <div class="schedule-content-holder">
      

      <!-- Existing Schedule Block -->
      <div id="schedule-block" class="schedule-block">
        <h1>SCHEDULE</h1>
          <div class="selector-row">
            <div class="season-selector">
              <%= form_with url: schedule_path, method: :get, local: true do %>
                <label for="season-select"><strong>Select Season:</strong></label>
                <%= select_tag :season, options_for_select(@available_seasons, @season), id: "season-select", onchange: "this.form.submit()" %>
              <% end %>
            </div>

            <div class="week-selector">
              <label for="week-select"><strong>Select Week:</strong></label>
              <select id="week-select" class="week-select">
                <% @weeks.each do |week| %>
                  <option value="<%= week.number %>" <%= 'selected' if week.number == @default_week_number %>>
                    Week <%= week.number %>
                  </option>
                <% end %>
              </select>
            </div>
          </div>


        <div class="schedule-tbl-holder">
          <% @weeks.each do |week| %>
            <table id="week<%= week.number %>" class="schedule-tbl" style="display: none;">
              <thead>
                <tr>
                  <th>Home Team</th>
                  <th>Score</th>
                  <th>Away Team</th>
                </tr>
              </thead>
              <tbody>
                <% week.games.each do |game| %>
                  <tr>
                    <td><%= game.home_team.name %></td>
                    <td><%= game.home_score %> vs <%= game.away_score %></td>
                    <td><%= game.away_team.name %></td>
                  </tr>
                <% end %>
              </tbody>
            </table>
          <% end %>
        </div>
      </div>

    </div>
  </div>
</div>

<script>
document.addEventListener("turbo:load", function() {
  const defaultWeek = <%= @default_week_number %>;

  // Show the default week's table
  const table = document.querySelector(`#week${defaultWeek}`);
  if (table) table.style.display = "table";

  // Update table on week dropdown change
  document.querySelector("#week-select").addEventListener("change", function() {
    const selectedWeek = this.value;

    document.querySelectorAll(".schedule-tbl").forEach(function(table) {
      table.style.display = "none";
    });

    const selectedTable = document.querySelector(`#week${selectedWeek}`);
    if (selectedTable) selectedTable.style.display = "table";
  });
});
</script>
